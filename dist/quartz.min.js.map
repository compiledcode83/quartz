{"version":3,"sources":["quartz.min.js"],"names":["root","factory","define","amd","exports","module","Quartz","this","config","columnClass","columnCount","yIndices","container","document","querySelector","items","toArray","querySelectorAll","mediaQueries","window","matchMedia","bindToMediaQueries","update","isArray","Array","prototype","append","length","columns","createColumnFragments","heights","getItemHeights","refreshYIndices","distributeItemsToColumns","i","children","appendChild","concat","prepend","createColumns","heights1","heights2","getExistingItemHeights","resetYIndices","removeColumns","childNodes","remove","index","_items","indexOf","splice","numColumns","columnIndex","item","count","getColumnIndex","min","Math","apply","l","push","offsetHeight","temp","createElement","className","style","position","left","top","width","removeChild","column","createDocumentFragment","firstChild","object","a","bindToMediaQueryList","that","mqlListener","mql","matches","mediaQueryList","query","addListener"],"mappings":"CAAE,SAASA,EAAMC,GACO,kBAAXC,SAAyBA,OAAOC,IACzCD,UAAWD,GACiB,gBAAZG,SAChBC,OAAOD,QAAUH,IAEjBD,EAAKM,OAASL,KAEhBM,KAAM,WACR,YAkBA,SAASD,GAAOE,GACdD,KAAKE,YAAcD,EAAOC,YAC1BF,KAAKG,YAAcF,EAAOE,YAC1BH,KAAKI,YAGHJ,KAAKK,UADyB,gBAArBJ,GAAOI,UACCC,SAASC,cAAcN,EAAOI,WAG9BJ,EAAOI,UAIxBL,KAAKQ,MAAQR,KAAKS,QADQ,gBAAjBR,GAAOO,MACUF,SAASI,iBAAiBT,EAAOO,OAGjCP,EAAOO,OAG/BP,EAAOU,cAAgBC,OAAOC,WAChCb,KAAKc,mBAAmBb,EAAOU,cAG/BX,KAAKe,SAtCT,GAAIC,GAAUC,MAAMD,OAmVpB,OAxSAjB,GAAOmB,WAKLC,OAAS,SAASX,GACY,mBAAjBA,GAAMY,SACfZ,GAASA,GAGX,IAAIH,GAAcL,KAAKK,UACnBgB,EAAcrB,KAAKsB,wBACnBnB,EAAcH,KAAKG,YACnBoB,EAAcvB,KAAKwB,eAAehB,EAEtCR,MAAKyB,kBACLzB,KAAK0B,yBAAyBlB,EAAOa,EAASE,EAE9C,KAAK,GAAII,GAAI,EAAOxB,EAAJwB,EAAiBA,IAC/BtB,EAAUuB,SAASD,GAAGE,YAAYR,EAAQM,GAG5C3B,MAAKQ,MAAQR,KAAKQ,MAAMsB,OAAO9B,KAAKS,QAAQD,KAO9CuB,QAAU,SAASvB,GACW,mBAAjBA,GAAMY,SACfZ,GAASA,GAGX,IAAIa,GAAWrB,KAAKgC,gBAChBC,EAAWjC,KAAKwB,eAAehB,GAC/B0B,EAAWlC,KAAKmC,yBAChBZ,EAAWU,EAASH,OAAOI,EAE/B1B,GAAQR,KAAKS,QAAQD,GAAOsB,OAAO9B,KAAKQ,OAExCR,KAAKoC,gBACLpC,KAAKqC,gBACLrC,KAAK0B,yBAAyBlB,EAAOa,EAAQiB,WAAYf,GACzDvB,KAAKK,UAAUwB,YAAYR,GAC3BrB,KAAKQ,MAAQA,GAOf+B,OAAS,SAAS/B,GACY,mBAAjBA,GAAMY,SACfZ,GAASA,GAOX,KAJA,GAEIgC,GAFAC,EAASzC,KAAKQ,MACdmB,EAAInB,EAAMY,OAGPO,KACLa,EAAQC,EAAOC,QAAQlC,EAAMmB,IACf,KAAVa,GACFC,EAAOE,OAAOH,EAAO,EAIzBxC,MAAKe,UAOPA,OAAS,SAAS6B,GACZA,IAAY5C,KAAKG,YAAcyC,EAEnC,IAAIvB,GAAUrB,KAAKgC,gBACfT,EAAUvB,KAAKmC,wBAEnBnC,MAAKoC,gBACLpC,KAAKqC,gBACLrC,KAAK0B,yBAAyB1B,KAAKQ,MAAOa,EAAQiB,WAAYf,GAC9DvB,KAAKK,UAAUwB,YAAYR,IAS7BK,yBAA2B,SAASlB,EAAOa,EAASE,GAMlD,IAAK,GAHDsB,GACAC,EAHAC,EAAQvC,EAAMY,OACdhB,EAAWJ,KAAKI,SAIXuB,EAAI,EAAOoB,EAAJpB,EAAWA,IACzBkB,EAAc7C,KAAKgD,iBACnBF,EAAOtC,EAAMmB,GACbvB,EAASyC,IAAgBtB,EAAQI,GACjCN,EAAQwB,GAAahB,YAAYiB,IAQrCE,eAAiB,WACf,GAAIC,GAAMC,KAAKD,IAAIE,MAAMD,KAAMlD,KAAKI,SACpC,OAAOJ,MAAKI,SAASsC,QAAQO,IAO/Bd,uBAAyB,WAIvB,IAAK,GAHD3B,GAAQR,KAAKQ,MACbe,KAEKI,EAAI,EAAGyB,EAAI5C,EAAMY,OAAYgC,EAAJzB,EAAOA,IACvCJ,EAAQ8B,KAAK7C,EAAMmB,GAAG2B,aAGxB,OAAO/B,IAQTC,eAAiB,SAAShB,GACxB,GAAI+C,GAAOjD,SAASkD,cAAc,MAClCD,GAAKE,UAAYzD,KAAKE,YACtBqD,EAAKG,MAAMC,SAAW,WACtBJ,EAAKG,MAAME,KAAO,WAClBL,EAAKG,MAAMG,IAAM,WACjBN,EAAKG,MAAMI,MAAQ9D,KAAKK,UAAUiD,aAAetD,KAAKG,YAAc,IAEpE,IAAIoB,MACAI,EAAI,EACJyB,EAAI5C,EAAMY,MAEd,KAAKO,EAAOyB,EAAJzB,EAAOA,IACb4B,EAAK1B,YAAYrB,EAAMmB,GAKzB,KAFA3B,KAAKK,UAAUwB,YAAY0B,GAEtB5B,EAAI,EAAOyB,EAAJzB,EAAOA,IACjBJ,EAAQ8B,KAAK7C,EAAMmB,GAAG2B,aAKxB,OAFAtD,MAAKK,UAAU0D,YAAYR,GAEpBhC,GAOTE,gBAAkB,WAChB,GAAIJ,GAAUrB,KAAKK,UAAUuB,SACzBmB,EAAQ1B,EAAQD,OAChBhB,EAAWJ,KAAKI,QAEpB,IAAI2C,EAAO,CACT3C,EAASgB,OAAS,CAElB,KAAK,GAAIO,GAAI,EAAOoB,EAAJpB,EAAWA,IACzBvB,EAASiD,KAAKhC,EAAQM,GAAG2B,gBAS/BlB,cAAgB,WACd,GAAIW,GAAQ/C,KAAKG,YACbC,EAAWJ,KAAKI,QAIpB,KAFAA,EAASgB,OAAS,EAEX2B,KACL3C,EAASiD,KAAK,IASlBrB,cAAgB,SAASe,GACvB,GACIiB,GADA3C,EAAUf,SAAS2D,wBAKvB,KAFAlB,EAAQA,GAAS/C,KAAKG,YAEf4C,KACLiB,EAAS1D,SAASkD,cAAc,OAChCQ,EAAOP,UAAYzD,KAAKE,YACxBmB,EAAQQ,YAAYmC,EAGtB,OAAO3C,IAQTC,sBAAwB,SAASyB,GAC/B,GAAIiB,KAIJ,KAFAjB,EAAQA,GAAS/C,KAAKG,YAEf4C,KACLiB,EAAOX,KAAK/C,SAAS2D,yBAGvB,OAAOD,IAOT3B,cAAgB,WAGd,IAFA,GAAIhC,GAAYL,KAAKK,UAEdA,EAAU6D,YACf7D,EAAU0D,YAAY1D,EAAU6D,aASpCzD,QAAU,SAAS0D,GACjB,GAAInD,EAAQmD,GAAS,MAAOA,EAE5B,IAAIxC,GAAIwC,EAAO/C,MAEf,IAAiB,gBAANO,GAAgB,CAEzB,IADA,GAAIyC,GAAI,GAAInD,OAAMU,GACXA,KAAOyC,EAAEzC,GAAKwC,EAAOxC,EAC5B,OAAOyC,GAGT,OAAQD,IAOVrD,mBAAqB,SAASH,GAE5B,IADA,GAAIgB,GAAIhB,EAAaS,OACdO,KACL3B,KAAKqE,qBAAqB1D,EAAagB,KAQ3C0C,qBAAuB,SAASpE,GAC9B,GAAIqE,GAAOtE,KAEPuE,EAAc,SAASC,GACrBA,EAAIC,UACNH,EAAKnE,YAAcF,EAAOoB,QAC1BiD,EAAKvD,WAIL2D,EAAiB9D,OAAOC,WAAWZ,EAAO0E,MAC9CD,GAAeE,YAAYL,GAC3BA,EAAYG,KAKT3E","file":"quartz.min.js","sourcesContent":[";(function(root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof exports === 'object') {\n    module.exports = factory();\n  } else {\n    root.Quartz = factory();\n  }\n}(this, function() {\n'use strict';\n\n\nvar isArray = Array.isArray;\n\n\n/**\n * @name Quartz\n * @constructor\n *\n * @param {{}}              config\n * @param {string}          config.columnClass\n * @param {number}          [config.columnCount]\n * @param {Element|string}  config.container\n * @param {NodeList|string} config.items\n * @param {Array}           [config.mediaQueries]\n *\n */\nfunction Quartz(config) {\n  this.columnClass = config.columnClass;\n  this.columnCount = config.columnCount;\n  this.yIndices = [];\n\n  if (typeof config.container === 'string') {\n    this.container = document.querySelector(config.container);\n  }\n  else {\n    this.container = config.container;\n  }\n\n  if (typeof config.items === 'string') {\n    this.items = this.toArray(document.querySelectorAll(config.items));\n  }\n  else {\n    this.items = this.toArray(config.items);\n  }\n\n  if (config.mediaQueries && window.matchMedia) {\n    this.bindToMediaQueries(config.mediaQueries);\n  }\n  else {\n    this.update();\n  }\n}\n\n\nQuartz.prototype = {\n\n  /**\n   * @param {Element|Element[]|NodeList} items\n   */\n  append : function(items) {\n    if (typeof items.length === 'undefined') {\n      items = [items];\n    }\n\n    var container   = this.container,\n        columns     = this.createColumnFragments(),\n        columnCount = this.columnCount,\n        heights     = this.getItemHeights(items);\n\n    this.refreshYIndices();\n    this.distributeItemsToColumns(items, columns, heights);\n\n    for (var i = 0; i < columnCount; i++) {\n      container.children[i].appendChild(columns[i]);\n    }\n\n    this.items = this.items.concat(this.toArray(items));\n  },\n\n\n  /**\n   * @param {Element|Element[]|NodeList} items\n   */\n  prepend : function(items) {\n    if (typeof items.length === 'undefined') {\n      items = [items];\n    }\n\n    var columns  = this.createColumns(),\n        heights1 = this.getItemHeights(items),\n        heights2 = this.getExistingItemHeights(),\n        heights  = heights1.concat(heights2);\n\n    items = this.toArray(items).concat(this.items);\n\n    this.resetYIndices();\n    this.removeColumns();\n    this.distributeItemsToColumns(items, columns.childNodes, heights);\n    this.container.appendChild(columns);\n    this.items = items;\n  },\n\n\n  /**\n   * @param {Element|Element[]|NodeList} items\n   */\n  remove : function(items) {\n    if (typeof items.length === 'undefined') {\n      items = [items];\n    }\n\n    var _items = this.items,\n        i = items.length,\n        index;\n\n    while (i--) {\n      index = _items.indexOf(items[i]);\n      if (index !== -1) {\n        _items.splice(index, 1);\n      }\n    }\n\n    this.update();\n  },\n\n\n  /**\n   * @param {number} [numColumns]\n   */\n  update : function(numColumns) {\n    if (numColumns) this.columnCount = numColumns;\n\n    var columns = this.createColumns(),\n        heights = this.getExistingItemHeights();\n\n    this.resetYIndices();\n    this.removeColumns();\n    this.distributeItemsToColumns(this.items, columns.childNodes, heights);\n    this.container.appendChild(columns);\n  },\n\n\n  /**\n   * @param {Element[]|NodeList} items\n   * @param {DocumentFragment[]|NodeList} columns\n   * @param {number[]} heights\n   */\n  distributeItemsToColumns : function(items, columns, heights) {\n    var count = items.length,\n        yIndices = this.yIndices,\n        columnIndex,\n        item;\n\n    for (var i = 0; i < count; i++) {\n      columnIndex = this.getColumnIndex();\n      item = items[i];\n      yIndices[columnIndex] += heights[i];\n      columns[columnIndex].appendChild(item);\n    }\n  },\n\n\n  /**\n   * @returns {number}\n   */\n  getColumnIndex : function() {\n    var min = Math.min.apply(Math, this.yIndices);\n    return this.yIndices.indexOf(min);\n  },\n\n\n  /**\n   * @returns {number[]}\n   */\n  getExistingItemHeights : function() {\n    var items = this.items,\n        heights = [];\n\n    for (var i = 0, l = items.length; i < l; i++) {\n      heights.push(items[i].offsetHeight);\n    }\n\n    return heights;\n  },\n\n\n  /**\n   * @param {Element[]|NodeList} items\n   * @returns {number[]}\n   */\n  getItemHeights : function(items) {\n    var temp = document.createElement('div');\n    temp.className = this.columnClass;\n    temp.style.position = 'absolute';\n    temp.style.left = '-10000px';\n    temp.style.top = '-10000px';\n    temp.style.width = this.container.offsetHeight / this.columnCount + 'px';\n\n    var heights = [],\n        i = 0,\n        l = items.length;\n\n    for (i; i < l; i++) {\n      temp.appendChild(items[i]);\n    }\n\n    this.container.appendChild(temp);\n\n    for (i = 0; i < l; i++) {\n      heights.push(items[i].offsetHeight);\n    }\n\n    this.container.removeChild(temp);\n\n    return heights;\n  },\n\n\n  /**\n   *\n   */\n  refreshYIndices : function() {\n    var columns = this.container.children,\n        count = columns.length,\n        yIndices = this.yIndices;\n\n    if (count) {\n      yIndices.length = 0;\n\n      for (var i = 0; i < count; i++) {\n        yIndices.push(columns[i].offsetHeight);\n      }\n    }\n  },\n\n\n  /**\n   *\n   */\n  resetYIndices : function() {\n    var count = this.columnCount,\n        yIndices = this.yIndices;\n\n    yIndices.length = 0;\n\n    while (count--) {\n      yIndices.push(0);\n    }\n  },\n\n\n  /**\n   * @param {number} [count]\n   * @returns {DocumentFragment}\n   */\n  createColumns : function(count) {\n    var columns = document.createDocumentFragment(),\n        column;\n\n    count = count || this.columnCount;\n\n    while (count--) {\n      column = document.createElement('div');\n      column.className = this.columnClass;\n      columns.appendChild(column);\n    }\n\n    return columns;\n  },\n\n\n  /**\n   * @param {number} [count]\n   * @returns {DocumentFragment[]}\n   */\n  createColumnFragments : function(count) {\n    var column = [];\n\n    count = count || this.columnCount;\n\n    while (count--) {\n      column.push(document.createDocumentFragment());\n    }\n\n    return column;\n  },\n\n\n  /**\n   *\n   */\n  removeColumns : function() {\n    var container = this.container;\n\n    while (container.firstChild) {\n      container.removeChild(container.firstChild);\n    }\n  },\n\n\n  /**\n   * @param {Element|Element[]|NodeList} object\n   * @returns {Element[]}\n   */\n  toArray : function(object) {\n    if (isArray(object)) return object;\n\n    var i = object.length;\n\n    if (typeof i === 'number') {\n      var a = new Array(i);\n      while (i--) { a[i] = object[i]; }\n      return a;\n    }\n\n    return [object];\n  },\n\n\n  /**\n   * @param {{query:string, columns:number}[]} mediaQueries\n   */\n  bindToMediaQueries : function(mediaQueries) {\n    var i = mediaQueries.length;\n    while (i--) {\n      this.bindToMediaQueryList(mediaQueries[i]);\n    }\n  },\n\n\n  /**\n   * @param {{query:string, columns:number}} config\n   */\n  bindToMediaQueryList : function(config) {\n    var that = this;\n\n    var mqlListener = function(mql) {\n      if (mql.matches) {\n        that.columnCount = config.columns;\n        that.update();\n      }\n    };\n\n    var mediaQueryList = window.matchMedia(config.query);\n    mediaQueryList.addListener(mqlListener);\n    mqlListener(mediaQueryList);\n  }\n\n};\n\nreturn Quartz;\n}));\n"],"sourceRoot":"/source/"}